# 魔力兑换助手

这是一个自动监控站点分享率和上传量，并在低于阈值时自动执行魔力兑换的插件。

## 功能特性

- ✅ **自动监控**: 默认每6小时自动监控站点分享率和上传量
- ✅ **智能兑换**: 当分享率或上传量低于阈值时自动执行魔力兑换
- ✅ **灵活配置**: 支持为每个站点单独配置兑换规则
- ✅ **安全间隔**: 每次兑换间隔30秒，避免频繁操作
- ✅ **通知系统**: 支持执行结果通知
- ✅ **定时执行**: 支持cron表达式自定义执行周期

## 配置说明

### 基本配置
- **启用插件**: 默认开启，插件处于激活状态
- **发送通知**: 默认开启，在特定事件发生时发送通知
- **执行周期**: 默认每6小时执行一次，可使用cron表达式自定义

### 监控阈值
- **分享率阈值**: 设置分享率阈值，低于此值将触发操作
- **魔力阈值**: 设置魔力阈值，低于此值将触发操作

### 站点兑换规则
每行配置一个站点，格式：`站点名称 上传量阈值 兑换规则`

**示例**:
```
学校 500G 2 5G 2300;3 10G 4200
```

**解释**:
- `学校` - 站点名称
- `500G` - 上传量阈值（当上传量低于500G时触发）
- `2 5G 2300` - 兑换规则1：选项2，兑换5G上传量，消耗2300魔力
- `3 10G 4200` - 兑换规则2：选项3，兑换10G上传量，消耗4200魔力

**兑换条件**:
- 上传量低于阈值
- 当前魔力值大于兑换所需魔力
- 距离上次兑换至少30秒

## 安装和使用

1. 将插件文件夹复制到Moviepilot的插件目录
2. 在Moviepilot后台启用插件
3. 配置以下参数：
   - **站点列表**: 选择要监控的站点
   - **执行周期**: 设置监控频率（默认每6小时）
   - **站点兑换规则**: 按格式配置每个站点的兑换规则
   - **分享率阈值**: 设置分享率监控阈值
   - **魔力阈值**: 设置魔力监控阈值

## 工作流程

1. 插件定时执行监控任务
2. 获取各站点的统计数据（上传量、下载量、分享率、魔力值等）
3. 检查分享率和魔力值是否低于阈值
4. 检查上传量是否低于配置的阈值
5. 如果满足兑换条件，自动执行魔力兑换操作
6. 发送监控结果和兑换结果通知

## 技术架构

- 基于Moviepilot插件标准架构
- 使用dataclass进行配置管理
- 支持事件驱动和定时任务
- 模块化设计，便于扩展
- 安全间隔控制，避免频繁操作